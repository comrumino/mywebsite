<pre id="code">
var active_color = &quot;#03a9f4&quot;,
    inactive_color = &quot;#ffffff&quot;;

var spanCanvas = function(a) {
    console.log(&quot;spanCanvas&quot;);
    this.sibling = a;
    this.canvas = document.createElement('canvas');
    this.canvas.className = &quot;collapsed&quot;;
    this.group = [this.sibling, this.canvas];
    var pa = 13,
        pw = pa * 0.45,
        ph = pw,
        px = pa * 0.55,
        py = px,
        ctx = this.canvas.getContext(&quot;2d&quot;);
    var plus_r = [
        [0, 0, pw, ph],
        [px, 0, pw, ph],
        [0, py, pw, ph],
        [px, py, pw, ph]
    ];

    var minus_r = [
        [0, 0, pa, ph],
        [0, py, pa, ph]
    ];

    ctx.canvas.width = pa;
    ctx.canvas.height = pa;
    ctx.clearRect(0, 0, pa, pa);
    ctx.fillStyle = inactive_color;
    for (var i = 0; i &lt; plus_r.length; i++) {
        ctx.fillRect(plus_r[i][0], plus_r[i][1], plus_r[i][2], plus_r[i][3]);
    }

    this.canvas.addEventListener('click', function (e) {
        e.preventDefault();
        if ($(this).hasClass(&quot;collapsed&quot;)) {
            ctx.clearRect(0, 0, pa, pa);
            ctx.fillStyle = active_color;
            for (var i = 0; i &lt; minus_r.length; i++) {
                ctx.fillRect(minus_r[i][0], minus_r[i][1], minus_r[i][2], minus_r[i][3]);
            }
        } else {
            ctx.clearRect(0, 0, pa, pa);
            ctx.fillStyle = active_color;
            for (var j = 0; j &lt; plus_r.length; j++) {
                ctx.fillRect(plus_r[j][0], plus_r[j][1], plus_r[j][2], plus_r[j][3]);
            }

        }
    });

    this.redraw = function() {
        if ($(this.canvas).hasClass(&quot;expanded&quot;)) {
            ctx.clearRect(0, 0, pa, pa);
            for (var i = 0; i &lt; minus_r.length; i++) {
                ctx.fillRect(minus_r[i][0], minus_r[i][1], minus_r[i][2], minus_r[i][3]);
            }
        } else {
            ctx.clearRect(0, 0, pa, pa);
            for (var j = 0; j &lt; plus_r.length; j++) {
                ctx.fillRect(plus_r[j][0], plus_r[j][1], plus_r[j][2], plus_r[j][3]);
            }

        }
    }

    this.setCanvasColor = function(zeColor) {
        console.log('setCanvasColor: '+zeColor);
        ctx.clearRect(0, 0, pa, pa);
        ctx.fillStyle = zeColor;
        if ($(this.canvas).hasClass(&quot;collapsed&quot;)) {
            for (var i = 0; i &lt; plus_r.length; i++) {
                ctx.fillRect(plus_r[i][0], plus_r[i][1], plus_r[i][2], plus_r[i][3]);
            }
        } else {
            for (var j = 0; j &lt; minus_r.length; j++) {
                ctx.fillRect(minus_r[j][0], minus_r[j][1], minus_r[j][2], minus_r[j][3]);
            }
        }
    }
}

function paddingAdjust(clicks, span, ul) {
    span.canvas.className = (ul.style.display == &quot;block&quot;) ? &quot;collapsed&quot; : &quot;expanded&quot;;
    ul.style.display = (ul.style.display == &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;
    span.redraw();
    if ($(ul).parentsUntil('#sitemap', 'ul').length == 0) {
        if (span.canvas.className == 'expanded') {
            if (clicks[0][0] != '') {
                clicks[0][0].canvas.className = (ul.style.display == &quot;block&quot;) ? &quot;collapsed&quot; : &quot;expanded&quot;;
                clicks[0][1].style.display = (ul.style.display == &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;
                clicks[0][0].redraw();
            }
            clicks[0][0] = span;
            clicks[0][1] = ul;
        } else {
            clicks[0][0] = '';
            clicks[0][1] = '';
        }
    } else if ($(ul).parentsUntil('#sitemap', 'ul').length == 1) {
        if (span.canvas.className == 'expanded') {
            if (clicks[1][0] != '') {
                clicks[1][0].canvas.className = (ul.style.display == &quot;block&quot;) ? &quot;collapsed&quot; : &quot;expanded&quot;;
                clicks[1][1].style.display = (ul.style.display == &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;
                clicks[1][0].redraw();
            }
            clicks[1][0] = span;
            clicks[1][1] = ul;
        } else {
            clicks[1][0] = '';
            clicks[1][1] = '';
        }
    }
    calculatePadding();
};

function calculatePadding(){
    var listem = $('#sitemap').find('a:visible'),
        largest = 0,
        sitemapWidth = $('#sitemap').width();
    for (var i = listem.length - 1; 0 &lt;= i; i--) {
        largest = (largest &gt;= parseInt(listem.eq(i).css('padding-left'), 10) + listem.eq(i).width()) ? largest : parseInt(listem.eq(i).css('padding-left'), 10) + listem.eq(i).width();
    };
    largest = largest + 5;
    for (var i = listem.length - 1; 0 &lt;= i; i--) {
        var fill = largest - parseInt(listem.eq(i).css('padding-left'), 10) - listem.eq(i).width();
        listem.eq(i).css({
            'paddingRight': fill + 'px'
        });
    };
};

function colorSync(scanvas) {
  if (!$(scanvas.canvas).is(':hover') &amp;&amp; !$(scanvas.sibling).is(':hover')) {
     console.log('colorSync: mouseleave group');
     scanvas.setCanvasColor(inactive_color);
     $(scanvas.sibling).removeClass('active');
  } else if (!$(scanvas.canvas).hasClass('active') &amp;&amp; !$(scanvas.sibling).hasClass('active')) {
     console.log('colorSync: mouseenter group');
     scanvas.setCanvasColor(active_color);
     $(scanvas.sibling).addClass('active');
  }
};

var sitemapstyler = function () {

    var levelZero = ['', ''],
        levelOne = ['', ''],
        code = '';
    var clicks = [levelZero, levelOne, code],
        items, span, selector, sitemap = document.getElementById(&quot;sitemap&quot;),
        code = document.getElementById(&quot;code&quot;),
        codetainer = document.getElementById(&quot;codetainer&quot;),
        listItem = function (li, a, ul) {
            if (li.getElementsByTagName(&quot;ul&quot;).length &gt; 0) {
                ul.style.display = &quot;none&quot;;
                scanvas = new spanCanvas(a);
                calculatePadding();
                $(scanvas.group).on('click', paddingAdjust.bind(this, clicks, scanvas, ul));
                $(scanvas.group).on('mouseenter mouseleave', colorSync.bind(this,scanvas));
                
                li.appendChild(scanvas.canvas);
            } else {
                selector = [a];
                $(selector).on('click', function (e) {
                    e.preventDefault();
                    if ($(this) != clicks[2]) {
                        if ($(this).hasClass(&quot;href&quot;)) {
                            $(code).remove();
                            $(codetainer).load(window.location.origin + '/static/' + $(this).attr(&quot;href&quot;) + ' #code');
                        }
                        if (!$(this).hasClass(&quot;active&quot;)) {
                            $(this).addClass('active');
                            $(clicks[2]).removeClass('active');
                        }
                        clicks[2] = $(this);
                    }
                });
            }
        };
    if (sitemap) {
        items = sitemap.getElementsByTagName(&quot;li&quot;);
        for (var i = 0; i &lt; items.length; i++) {
            listItem(items[i], items[i].getElementsByTagName(&quot;a&quot;)[0], items[i].getElementsByTagName(&quot;ul&quot;)[0]);
        };
    };
    $(&quot;#portfolio&quot;).on('click', calculatePadding.bind(this));
};
sitemapstyler();
</pre>
