<pre id="code">
#!/bin/bash
#
# Script: funcFormat.sh
# Author: Stronz
# Date  : July 2015
#
# Platform: MAC OSX YOSEMITE
#
# Purpose: loop over a list of function and format them into a lua script
#
################################################################################
#	VARIABLES HERE
################################################################################
OUTPUT='./output.txt'
DLL=''

################################################################################
#	FUNCTIONS HERE
################################################################################
function format () {
  while read FUNC; do
  LINE_TWO=&quot;function cb_${FUNC}(args)&quot;
  LINE_THR=&quot;  print(string.format(\&quot;%.3f,%.0f,${FUNC},\&quot;,os.clock(),GetTIB()))&quot;
  LINE_FOU=&quot;end&quot;
  LINE_FIV=&quot;addr = function(\&quot;$DLL\&quot;, \&quot;${FUNC}\&quot;, cb_${FUNC})&quot;
  A=(&quot;${LINE_TWO}&quot; &quot;${LINE_THR}&quot; &quot;${LINE_FOU}&quot; &quot;${LINE_FIV}&quot; &quot;${LINE_SIX}&quot;)
  IFS=$'
'
  echo &quot;${A[*]}&quot; &gt;&gt; $OUTPUT
  done
}

function formatEaDUMPBIN_H(){
  while read DUMPBIN; do
    DLL=$(sed '9q;d' $DUMPBIN | sed -n 's/^.* \(.*\.dll\)$/\1/p' | tr '[:upper:]' '[:lower:]')
    cat  $DUMPBIN | grep '[hH]eap' | sed -n 's/^.*[ ]\([a-zA-z]*\)$/\1/p' | format
  done
}

function formatEaDUMPBIN(){
  while read DUMPBIN; do
    DLL=$(sed '9q;d' $DUMPBIN | sed -n 's/^.* \(.*\.dll\)$/\1/p' | tr '[:upper:]' '[:lower:]')
    cat  $DUMPBIN | sed -n 's/^.*[ ]\([a-zA-z]*\)$/\1/p' | format
  done
}

function formatDUMPBIN_A(){
  ls -a ./ | grep &quot;DUMPBIN_A_.*&quot; | formatEaDUMPBIN_H
}

function formatDUMPBIN(){
  ls -a ./ | grep &quot;DUMPBIN_[^_][^_].*&quot; | formatEaDUMPBIN
}

function removeEmptyLines(){
  sed '/^$/d' $1
}

function removeExcess(){
  removeEmptyLines $OUTPUT &gt; tmp
  cat tmp &gt;&gt; $OUTPUT
  rm tmp
}

################################################################################
#	BEGINNING OF MAIN
################################################################################
#touch $OUTPUT
echo '' &gt; $OUTPUT
#formatDUMPBIN_A
formatDUMPBIN
removeExcess
</pre>