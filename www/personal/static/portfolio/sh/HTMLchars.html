<pre id="code">
#!/bin/bash
#
# Script: HTMLchars
# Author: Stronz
# Date  : Jun 2015
#
# Platform: Arch Linux
#
# Purpose: convert html special characters
#
################################################################################
#	DEFINE VARIABLES HERE
################################################################################
dir=&quot;$( cd &quot;$( dirname &quot;${BASH_SOURCE[0]}&quot; )&quot; &amp;&amp; pwd )&quot;
nportfolio=&quot;$dir/newPortfolio&quot;
oportfolio=&quot;$dir/oldPortfolio&quot;
portfolio=&quot;$dir/portfolio&quot;
archiveName=&quot;./archive.tar&quot;

################################################################################
#	DEFINE FUNCTIONS HERE
################################################################################
function beginArchiving() {
    cp -r $nportfolio $oportfolio   
}

function HTMLchars() {
    while read f; do
        perl -pi -e 'BEGIN { use CGI qw(escapeHTML); } $_ = escapeHTML($_);' $f
    done 
}

function forAllFiles() {
    find $1 -name [^.]\*.\* -print
}

function finishArchiving() {
    mv $nportfolio/* $portfolio/
    if [ -e $archiveName ]; then
        tar -uf $archiveName
    else
        tar -cf $archiveName $dir/[^\.]
        tar --delete $dir/HTMLchars.sh $dir/newPortfolio $dir/oldPortfolio $dir/.*swp -f $archiveName
    fi

    rm -r $portfolio/*
}

################################################################################
#	BEGINNING OF MAIN
################################################################################
beginArchiving
forAllFiles &quot;$nportfolio&quot; | HTMLchars
finishArchiving
</pre>